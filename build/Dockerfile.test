FROM golang:1.13 as builder

RUN go get github.com/onsi/ginkgo/ginkgo
RUN go get github.com/onsi/gomega/...
RUN GO111MODULE=on go get github.com/mikefarah/yq/v3

USER root

ENV KUBECONFIG "/opt/.kube/config"

WORKDIR /usr/src/app

COPY go.mod .
COPY go.sum .

COPY test ./test

RUN go mod tidy

ENTRYPOINT [ "./test/start-tests.sh" ]